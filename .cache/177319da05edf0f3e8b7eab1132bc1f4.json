{"dependencies":[{"name":"/home/user/vipfy-server/.babelrc","includedInParent":true,"mtime":1516814375768},{"name":"babel-runtime/regenerator"},{"name":"babel-runtime/helpers/asyncToGenerator"}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.requiresAdmin = exports.requiresAuth = undefined;\n\nvar _regenerator = require(\"babel-runtime/regenerator\");\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nvar _asyncToGenerator2 = require(\"babel-runtime/helpers/asyncToGenerator\");\n\nvar _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//Higher order component\nvar createResolver = function createResolver(resolver) {\n  var baseResolver = resolver;\n  baseResolver.createResolver = function (childResolver) {\n    var newResolver = function () {\n      var _ref = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee(parent, args, context, info) {\n        return _regenerator2.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return resolver(parent, args, context, info);\n\n              case 2:\n                return _context.abrupt(\"return\", childResolver(parent, args, context, info));\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, undefined);\n      }));\n\n      return function newResolver(_x, _x2, _x3, _x4) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n    return createResolver(newResolver);\n  };\n  return baseResolver;\n};\n\n//Check whether the user is authenticated\nvar requiresAuth = exports.requiresAuth = createResolver(function (parent, args, _ref2) {\n  var user = _ref2.user;\n\n  if (!user || !user.id) {\n    throw new Error(\"Not authenticated!\");\n  }\n});\n\n//These functions can be nested. Here it checks first whether an user\n//is authenticated and then if he has admin status.\nvar requiresAdmin = exports.requiresAdmin = requiresAuth.createResolver(function (parent, args, context) {\n  if (!context.user.isAdmin) {\n    throw new Error(\"Requires admin privileges\");\n  }\n});","map":{"mappings":[{"generated":{"line":18,"column":0},"source":"helpers/permissions.js","original":{"line":1,"column":0}},{"generated":{"line":19,"column":0},"source":"helpers/permissions.js","original":{"line":2,"column":0}},{"name":"createResolver","generated":{"line":19,"column":4},"source":"helpers/permissions.js","original":{"line":2,"column":6}},{"generated":{"line":19,"column":21},"source":"helpers/permissions.js","original":{"line":2,"column":23}},{"name":"createResolver","generated":{"line":19,"column":30},"source":"helpers/permissions.js","original":{"line":2,"column":6}},{"generated":{"line":19,"column":44},"source":"helpers/permissions.js","original":{"line":2,"column":23}},{"generated":{"line":19,"column":55},"source":"helpers/permissions.js","original":{"line":2,"column":35}},{"generated":{"line":20,"column":0},"source":"helpers/permissions.js","original":{"line":3,"column":2}},{"name":"baseResolver","generated":{"line":20,"column":6},"source":"helpers/permissions.js","original":{"line":3,"column":8}},{"name":"resolver","generated":{"line":20,"column":21},"source":"helpers/permissions.js","original":{"line":3,"column":23}},{"generated":{"line":20,"column":29},"source":"helpers/permissions.js","original":{"line":3,"column":2}},{"name":"baseResolver","generated":{"line":21,"column":0},"source":"helpers/permissions.js","original":{"line":4,"column":2}},{"name":"createResolver","generated":{"line":21,"column":15},"source":"helpers/permissions.js","original":{"line":4,"column":15}},{"generated":{"line":21,"column":29},"source":"helpers/permissions.js","original":{"line":4,"column":2}},{"generated":{"line":21,"column":32},"source":"helpers/permissions.js","original":{"line":4,"column":32}},{"generated":{"line":21,"column":57},"source":"helpers/permissions.js","original":{"line":4,"column":49}},{"generated":{"line":22,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":4}},{"name":"newResolver","generated":{"line":22,"column":8},"source":"helpers/permissions.js","original":{"line":5,"column":10}},{"generated":{"line":23,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":10}},{"generated":{"line":23,"column":90},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"name":"parent","generated":{"line":23,"column":107},"source":"helpers/permissions.js","original":{"line":5,"column":31}},{"generated":{"line":23,"column":113},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"name":"args","generated":{"line":23,"column":115},"source":"helpers/permissions.js","original":{"line":5,"column":39}},{"generated":{"line":23,"column":119},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"name":"context","generated":{"line":23,"column":121},"source":"helpers/permissions.js","original":{"line":5,"column":45}},{"generated":{"line":23,"column":128},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"name":"info","generated":{"line":23,"column":130},"source":"helpers/permissions.js","original":{"line":5,"column":54}},{"generated":{"line":23,"column":134},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"generated":{"line":24,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"generated":{"line":25,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"generated":{"line":26,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"generated":{"line":27,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"generated":{"line":28,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"generated":{"line":29,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"name":"resolver","generated":{"line":29,"column":23},"source":"helpers/permissions.js","original":{"line":6,"column":12}},{"name":"parent","generated":{"line":29,"column":32},"source":"helpers/permissions.js","original":{"line":6,"column":21}},{"generated":{"line":29,"column":38},"source":"helpers/permissions.js","original":{"line":6,"column":12}},{"name":"args","generated":{"line":29,"column":40},"source":"helpers/permissions.js","original":{"line":6,"column":29}},{"generated":{"line":29,"column":44},"source":"helpers/permissions.js","original":{"line":6,"column":12}},{"name":"context","generated":{"line":29,"column":46},"source":"helpers/permissions.js","original":{"line":6,"column":35}},{"generated":{"line":29,"column":53},"source":"helpers/permissions.js","original":{"line":6,"column":12}},{"name":"info","generated":{"line":29,"column":55},"source":"helpers/permissions.js","original":{"line":6,"column":44}},{"generated":{"line":29,"column":59},"source":"helpers/permissions.js","original":{"line":6,"column":12}},{"generated":{"line":29,"column":60},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"generated":{"line":31,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"generated":{"line":32,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"name":"childResolver","generated":{"line":32,"column":49},"source":"helpers/permissions.js","original":{"line":7,"column":13}},{"name":"parent","generated":{"line":32,"column":63},"source":"helpers/permissions.js","original":{"line":7,"column":27}},{"generated":{"line":32,"column":69},"source":"helpers/permissions.js","original":{"line":7,"column":13}},{"name":"args","generated":{"line":32,"column":71},"source":"helpers/permissions.js","original":{"line":7,"column":35}},{"generated":{"line":32,"column":75},"source":"helpers/permissions.js","original":{"line":7,"column":13}},{"name":"context","generated":{"line":32,"column":77},"source":"helpers/permissions.js","original":{"line":7,"column":41}},{"generated":{"line":32,"column":84},"source":"helpers/permissions.js","original":{"line":7,"column":13}},{"name":"info","generated":{"line":32,"column":86},"source":"helpers/permissions.js","original":{"line":7,"column":50}},{"generated":{"line":32,"column":90},"source":"helpers/permissions.js","original":{"line":7,"column":13}},{"generated":{"line":32,"column":91},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"generated":{"line":34,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"generated":{"line":35,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"generated":{"line":36,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"generated":{"line":37,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"generated":{"line":38,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"generated":{"line":39,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"generated":{"line":40,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":24}},{"generated":{"line":40,"column":7},"source":"helpers/permissions.js","original":{"line":5,"column":10}},{"generated":{"line":42,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":10}},{"generated":{"line":43,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":10}},{"generated":{"line":44,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":10}},{"generated":{"line":45,"column":0},"source":"helpers/permissions.js","original":{"line":5,"column":10}},{"generated":{"line":45,"column":7},"source":"helpers/permissions.js","original":{"line":5,"column":4}},{"generated":{"line":46,"column":0},"source":"helpers/permissions.js","original":{"line":9,"column":4}},{"name":"createResolver","generated":{"line":46,"column":11},"source":"helpers/permissions.js","original":{"line":9,"column":11}},{"name":"newResolver","generated":{"line":46,"column":26},"source":"helpers/permissions.js","original":{"line":9,"column":26}},{"generated":{"line":46,"column":37},"source":"helpers/permissions.js","original":{"line":9,"column":11}},{"generated":{"line":46,"column":38},"source":"helpers/permissions.js","original":{"line":9,"column":4}},{"generated":{"line":47,"column":0},"source":"helpers/permissions.js","original":{"line":10,"column":3}},{"generated":{"line":47,"column":3},"source":"helpers/permissions.js","original":{"line":4,"column":2}},{"generated":{"line":48,"column":0},"source":"helpers/permissions.js","original":{"line":11,"column":2}},{"name":"baseResolver","generated":{"line":48,"column":9},"source":"helpers/permissions.js","original":{"line":11,"column":9}},{"generated":{"line":48,"column":21},"source":"helpers/permissions.js","original":{"line":11,"column":2}},{"generated":{"line":49,"column":0},"source":"helpers/permissions.js","original":{"line":12,"column":1}},{"generated":{"line":49,"column":1},"source":"helpers/permissions.js","original":{"line":2,"column":0}},{"generated":{"line":51,"column":0},"source":"helpers/permissions.js","original":{"line":14,"column":0}},{"generated":{"line":52,"column":0},"source":"helpers/permissions.js","original":{"line":15,"column":7}},{"name":"requiresAuth","generated":{"line":52,"column":4},"source":"helpers/permissions.js","original":{"line":15,"column":13}},{"name":"createResolver","generated":{"line":52,"column":42},"source":"helpers/permissions.js","original":{"line":15,"column":28}},{"generated":{"line":52,"column":57},"source":"helpers/permissions.js","original":{"line":15,"column":43}},{"name":"parent","generated":{"line":52,"column":67},"source":"helpers/permissions.js","original":{"line":15,"column":44}},{"generated":{"line":52,"column":73},"source":"helpers/permissions.js","original":{"line":15,"column":43}},{"name":"args","generated":{"line":52,"column":75},"source":"helpers/permissions.js","original":{"line":15,"column":52}},{"generated":{"line":52,"column":79},"source":"helpers/permissions.js","original":{"line":15,"column":43}},{"generated":{"line":52,"column":88},"source":"helpers/permissions.js","original":{"line":15,"column":71}},{"generated":{"line":53,"column":0},"source":"helpers/permissions.js","original":{"line":15,"column":71}},{"name":"user","generated":{"line":53,"column":6},"source":"helpers/permissions.js","original":{"line":15,"column":60}},{"generated":{"line":53,"column":10},"source":"helpers/permissions.js","original":{"line":15,"column":71}},{"name":"user","generated":{"line":53,"column":19},"source":"helpers/permissions.js","original":{"line":15,"column":60}},{"generated":{"line":53,"column":23},"source":"helpers/permissions.js","original":{"line":15,"column":71}},{"generated":{"line":55,"column":0},"source":"helpers/permissions.js","original":{"line":16,"column":2}},{"generated":{"line":55,"column":6},"source":"helpers/permissions.js","original":{"line":16,"column":6}},{"name":"user","generated":{"line":55,"column":7},"source":"helpers/permissions.js","original":{"line":16,"column":7}},{"generated":{"line":55,"column":11},"source":"helpers/permissions.js","original":{"line":16,"column":6}},{"generated":{"line":55,"column":15},"source":"helpers/permissions.js","original":{"line":16,"column":15}},{"name":"user","generated":{"line":55,"column":16},"source":"helpers/permissions.js","original":{"line":16,"column":16}},{"name":"id","generated":{"line":55,"column":21},"source":"helpers/permissions.js","original":{"line":16,"column":21}},{"generated":{"line":55,"column":23},"source":"helpers/permissions.js","original":{"line":16,"column":2}},{"generated":{"line":55,"column":25},"source":"helpers/permissions.js","original":{"line":16,"column":25}},{"generated":{"line":56,"column":0},"source":"helpers/permissions.js","original":{"line":17,"column":4}},{"generated":{"line":56,"column":10},"source":"helpers/permissions.js","original":{"line":17,"column":10}},{"name":"Error","generated":{"line":56,"column":14},"source":"helpers/permissions.js","original":{"line":17,"column":14}},{"generated":{"line":56,"column":19},"source":"helpers/permissions.js","original":{"line":17,"column":10}},{"generated":{"line":56,"column":20},"source":"helpers/permissions.js","original":{"line":17,"column":20}},{"generated":{"line":56,"column":40},"source":"helpers/permissions.js","original":{"line":17,"column":10}},{"generated":{"line":56,"column":41},"source":"helpers/permissions.js","original":{"line":17,"column":4}},{"generated":{"line":57,"column":0},"source":"helpers/permissions.js","original":{"line":18,"column":3}},{"generated":{"line":58,"column":0},"source":"helpers/permissions.js","original":{"line":19,"column":1}},{"generated":{"line":58,"column":1},"source":"helpers/permissions.js","original":{"line":15,"column":28}},{"generated":{"line":58,"column":2},"source":"helpers/permissions.js","original":{"line":15,"column":7}},{"generated":{"line":60,"column":0},"source":"helpers/permissions.js","original":{"line":21,"column":0}},{"generated":{"line":61,"column":0},"source":"helpers/permissions.js","original":{"line":22,"column":0}},{"generated":{"line":62,"column":0},"source":"helpers/permissions.js","original":{"line":23,"column":7}},{"name":"requiresAdmin","generated":{"line":62,"column":4},"source":"helpers/permissions.js","original":{"line":23,"column":13}},{"name":"requiresAuth","generated":{"line":62,"column":44},"source":"helpers/permissions.js","original":{"line":23,"column":29}},{"name":"createResolver","generated":{"line":62,"column":57},"source":"helpers/permissions.js","original":{"line":23,"column":42}},{"generated":{"line":62,"column":71},"source":"helpers/permissions.js","original":{"line":23,"column":29}},{"generated":{"line":62,"column":72},"source":"helpers/permissions.js","original":{"line":24,"column":2}},{"name":"parent","generated":{"line":62,"column":82},"source":"helpers/permissions.js","original":{"line":24,"column":3}},{"generated":{"line":62,"column":88},"source":"helpers/permissions.js","original":{"line":24,"column":2}},{"name":"args","generated":{"line":62,"column":90},"source":"helpers/permissions.js","original":{"line":24,"column":11}},{"generated":{"line":62,"column":94},"source":"helpers/permissions.js","original":{"line":24,"column":2}},{"name":"context","generated":{"line":62,"column":96},"source":"helpers/permissions.js","original":{"line":24,"column":17}},{"generated":{"line":62,"column":103},"source":"helpers/permissions.js","original":{"line":24,"column":2}},{"generated":{"line":62,"column":105},"source":"helpers/permissions.js","original":{"line":24,"column":29}},{"generated":{"line":63,"column":0},"source":"helpers/permissions.js","original":{"line":25,"column":4}},{"generated":{"line":63,"column":6},"source":"helpers/permissions.js","original":{"line":25,"column":8}},{"name":"context","generated":{"line":63,"column":7},"source":"helpers/permissions.js","original":{"line":25,"column":9}},{"name":"user","generated":{"line":63,"column":15},"source":"helpers/permissions.js","original":{"line":25,"column":17}},{"generated":{"line":63,"column":19},"source":"helpers/permissions.js","original":{"line":25,"column":9}},{"name":"isAdmin","generated":{"line":63,"column":20},"source":"helpers/permissions.js","original":{"line":25,"column":22}},{"generated":{"line":63,"column":27},"source":"helpers/permissions.js","original":{"line":25,"column":4}},{"generated":{"line":63,"column":29},"source":"helpers/permissions.js","original":{"line":25,"column":31}},{"generated":{"line":64,"column":0},"source":"helpers/permissions.js","original":{"line":26,"column":6}},{"generated":{"line":64,"column":10},"source":"helpers/permissions.js","original":{"line":26,"column":12}},{"name":"Error","generated":{"line":64,"column":14},"source":"helpers/permissions.js","original":{"line":26,"column":16}},{"generated":{"line":64,"column":19},"source":"helpers/permissions.js","original":{"line":26,"column":12}},{"generated":{"line":64,"column":20},"source":"helpers/permissions.js","original":{"line":26,"column":22}},{"generated":{"line":64,"column":47},"source":"helpers/permissions.js","original":{"line":26,"column":12}},{"generated":{"line":64,"column":48},"source":"helpers/permissions.js","original":{"line":26,"column":6}},{"generated":{"line":65,"column":0},"source":"helpers/permissions.js","original":{"line":27,"column":5}},{"generated":{"line":66,"column":0},"source":"helpers/permissions.js","original":{"line":28,"column":3}},{"generated":{"line":66,"column":1},"source":"helpers/permissions.js","original":{"line":23,"column":29}},{"generated":{"line":66,"column":2},"source":"helpers/permissions.js","original":{"line":23,"column":7}}],"sources":{"helpers/permissions.js":"//Higher order component\nconst createResolver = resolver => {\n  const baseResolver = resolver;\n  baseResolver.createResolver = childResolver => {\n    const newResolver = async (parent, args, context, info) => {\n      await resolver(parent, args, context, info);\n      return childResolver(parent, args, context, info);\n    };\n    return createResolver(newResolver);\n  };\n  return baseResolver;\n};\n\n//Check whether the user is authenticated\nexport const requiresAuth = createResolver((parent, args, { user }) => {\n  if (!user || !user.id) {\n    throw new Error(\"Not authenticated!\");\n  }\n});\n\n//These functions can be nested. Here it checks first whether an user\n//is authenticated and then if he has admin status.\nexport const requiresAdmin = requiresAuth.createResolver(\n  (parent, args, context) => {\n    if (!context.user.isAdmin) {\n      throw new Error(\"Requires admin privileges\");\n    }\n  }\n);\n"},"lineCount":null}},"hash":"f53c7c1c021e7de3709787c35054faee","cacheData":{"env":{}}}