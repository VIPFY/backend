export default (sequelize, { BOOLEAN, TEXT, INTEGER, ARRAY }) => {
  const Phone = sequelize.define("phone_data", {
    number: { type: TEXT, allowNull: false },
    verified: { type: BOOLEAN, defaulValue: false },
    autogenerated: { type: BOOLEAN, defaultValue: false },
    description: TEXT,
    priority: INTEGER,
    tags: {
      type: ARRAY(TEXT),
      set(values) {
        const normalizedValues = values.map(value => value.toLowerCase());
        this.setDataValue("tags", normalizedValues);
      }
    }
  });

  Phone.associate = ({ Unit }) => {
    Phone.belongsTo(Unit, { foreignKey: "unitid" });
  };

  Phone.removeAttribute("id");

  return Phone;
};
